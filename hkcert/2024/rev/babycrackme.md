# Baby Cracker

This chall provide us a binary, oppening it on ida we get this code: 

```c
int main(int _argc, char *_argv[], char *_envp[])
{
  int i; // [rsp+Ch] [rbp-124h]
  int validation_counter; // [rsp+18h] [rbp-118h]
  int n; // [rsp+1Ch] [rbp-114h]
  char input[256]; // [rsp+20h] [rbp-110h] BYREF
  char **__attribute__((__org_arrdim(0,0))) argv; // [rsp+120h] [rbp-10h]
  int argc; // [rsp+128h] [rbp-8h]
  int zero; // [rsp+12Ch] [rbp-4h]

  zero = 0;
  argc = _argc;
  argv = _argv;
  printf("Enter the flag: ");
  __isoc99_scanf("%s", input);
  if ( strstr(input, needle) != input )
    goto invalid_flag;
  n = strlen(input);
  if ( strchr(input, 125) != &input[n - 1]
    || input[n - 2] != 49
    || input[n - 5] + input[n - 4] + input[n - 3] != 300
    || 2 * input[n - 5] + input[n - 4] + 2 * input[n - 3] != 496
    || 2 * input[n - 5] + 3 * input[n - 4] + input[n - 3] != 607 )
  {
    goto invalid_flag;
  }
  validation_counter = 0;
  for ( i = 0; i < n - 14 && (*((char *)flag_xored + i) ^ input[i + 9]) == xored[i]; ++i )
    ++validation_counter;
  if ( validation_counter == 28 && i == n - 14 )
  {
    printf("You are now verified!\n");
    return 0;
  }
  else
  {
invalid_flag:
    printf("Bye\n");
    return -1;
  }
}
```

First it compare our inputs with the neddle string wich is `"hkcert24{"`
Then it verify the last 5 characters with this condition:

```c
strchr(input, 125) != &input[n - 1]
    || input[n - 2] != 49
    || input[n - 5] + input[n - 4] + input[n - 3] != 300
    || 2 * input[n - 5] + input[n - 4] + 2 * input[n - 3] != 496
    || 2 * input[n - 5] + 3 * input[n - 4] + input[n - 3] != 607 )
```

Solving this simple equation we get: `cha1}`

Finally it compute some xor beetween `flag_xored` and `xored`.

Dumping those variables we can make this solve script:

```py
xored = [0xbd,0x10,0xb6,0x50,0xbd,0x35,0xbf,0x78,0x7f,0xa,0x98,0x61,0x1f,0x1c,0xcb,0xa9,0xf0,0xd9,0x6c,0x5,0xee,0xac,0xb8,0x98,0x9d,0x77,0x3c,0xbc,0x81,0x2e,0xa0,0x79,0x3d,0x8b,0x77,0xdd,0x7f,0x6f,0xe3,0x2,0x2b,0x43,0x38,0x68,0xa8,0xd7,0x12,0xa,0xa1,0xdc,0xf5,0xf3,0x83,0x21,0xdc,0x67,0xda,0x66,0x9b,0x77,0xd3,0xa9,0x55,0xe2,0x6e,0x3a,0x2e,0x62,0x8e,0x5e,0x88,0x62,0x36,0xa1,0xe7,0x2d,0x91,0xf2,0x32,0x93,0x67,0x7b,0xbd,0xf0,0xcd,0x10,0xda,0x7f,0x2c,0x78,0x56,0x8a,0xa0,0x38,0x2e,0xe1,0xb1,0x88,0xb0,0x47,0x13,0x4,0xf7,0xc4,0x63,0x14,0xdb,0xc,0xbb,0x13,0x4b,0xef,0xbb,0x72,0x24,0x14,0x59,0x83,0x90,0xa4,0x9,0x69,0xcc,0x7a,0xe2,0x9e,0x8c,0x8f,0x69,0xa1,0xed,0x4d,0xe9,0x50,0xa2,0x32,0xfe,0x24,0x8a,0x54,0x7f,0xff,0x14,0x81,0x1d,0xb6,0xc1,0x39,0x77,0x8a,0x70,0xf3,0x2c,0x77,0xb2,0xce,0x37,0xad,0x7,0x3,0x6e,0xbe,0x18,0xf8,0x42,0x90,0x41,0x8a,0xe6,0xfc,0x62,0x34,0x6a,0xce,0x52,0x9a,0x79,0x6a,0x35,0x8a,0x4d,0x35,0x81,0x22,0x43,0x28,0xd2,0x96,0xd4,0x9b,0x2c,0xee,0x9f,0xfd,0x8f,0xbe,0x81,0x78,0x33,0xf0,0x6,0x82,0x15,0xce,0xc1,0x74,0x72,0x42,0x64,0x33,0xc3,0x17,0x90,0xde,0x12,0xdb,0xc3,0x70,0xa1,0x56,0x7e,0x2d,0x92,0x15,0x45,0xba,0x7a,0x62,0x4f,0xef,0xcf,0x7e,0x55,0x3e,0x4a,0x42,0xa9,0xb3,0xe8,0x65,0x51,0xef,0x60,0x9b,0xb7,0x1e,0x5a,0x67,0x98,0xcb,0xc1,0x20,0x41,0x92,0xda,0x6e,0x0]
flag_xored = [0xce,0x21,0xdb,0x64,0xd1,0x50,0xe0,0x1b,0xd,0x3e,0xfb,0xa,0x52,0x2f,0x94,0x9d,0xaf,0xb1,0x58,0x6b,0x8a,0xee,0xc1,0xf0,0xfc,0x19,0xa,0xe3,0xe9,0x1e,0xd0,0x4a,0x62,0xf2,0x47,0xa8,0x20,0xb,0xd3,0x6c,0x1c,0x1c,0x56,0x5b,0x9b,0xb3,0x4d,0x3d,0xce,0x83,0x80,0xc0,0xe6,0x7e,0xe8,0x9,0xbd,0x14,0xc4,0x47,0xa1,0xf6,0x2f,0xd1,0x31,0x5c,0x1e,0x10,0xd1,0x2a,0xe0,0x53,0x45,0xfe,0x85,0x58,0xa6,0xad,0x3,0xcc,0x10,0x4b,0xd3,0x94,0xfe,0x62,0x85,0x4e,0x4a,0x27,0x35,0xe2,0x94,0xf,0x49,0x91,0x86,0xd7,0x80,0x35,0x4c,0x67,0xc3,0xaa,0x3c,0x67,0xe8,0x3f,0xe4,0x67,0x23,0xde,0x8e,0x2d,0x46,0x25,0x36,0xe1,0xf3,0x90,0x7d,0xf,0xb9,0x14,0x8c,0xe7,0xb6,0xa6,0x1a,0x90,0x80,0x79,0x85,0x35,0xfd,0x51,0x8c,0x10,0xe9,0x3f,0x32,0xcc,0x4b,0xb5,0x42,0xde,0xf5,0x57,0x13,0xc8,0x9,0x9b,0x4d,0x19,0x84,0x91,0x5f,0x9d,0x77,0x30,0x31,0xc7,0x28,0x8d,0x1d,0xf4,0x71,0xe4,0xd1,0xa3,0xc,0x7,0x59,0xaa,0xd,0xad,0x16,0x35,0x40,0xb9,0x28,0x6a,0xb5,0x4c,0x24,0x5a,0x8d,0xa6,0xa6,0xc4,0x56,0xdd,0xc0,0x9b,0xbf,0xcc,0xde,0xc,0x5b,0xc1,0x75,0xdd,0x77,0xbb,0xf6,0x2b,0x43,0x1d,0x13,0x3,0xad,0x73,0xa3,0xac,0x4d,0xea,0xa5,0x2f,0xc2,0x3e,0x4a,0x1a,0xf5,0x65,0x72,0xe5,0x4a,0x10,0x10,0x8c,0xfb,0x10,0xa,0x4d,0x79,0x71,0xf6,0xc7,0x80,0x54,0x64,0xb0,0x2,0xaa,0xd8,0x7c,0x39,0x53,0xec,0xad,0xb4,0x4e,0x2f,0xeb,0xe0,0x47,0x0]

flag = "hkcert24{"
for i in range(min(len(flag_xored), len(xored))):
    flag += chr(flag_xored[i] ^ xored[i])

print(flag[:28+9] + "cha1}")
```
